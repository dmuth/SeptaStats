
{% extends "base.html" %}

{% block title %}API Endpoints - Septa Stats!{% endblock %}

{% block content %}

<script src="https://cdnjs.cloudflare.com/ajax/libs/canvasjs/1.7.0/canvasjs.min.js" ></script>


<div class="row">

<div class="col-md-8">

<h1>API Endpoints</h1>


What follows are a list of API endpoints that are provided here.  These endpoints
are the same ones used in the public facing graphs on this site.
<br/>
<br/>

Unless specified otherwise, all data is returned in JSON format, with a field called "metadata" which holds data
related to the query, and "data" which holds the results of the query itself.
<br/>
<br/>

Please be considerate and try to hit each endpoint no more than once per minute.
If I have to go and implement a quota policy, that's no fun for anyone.
<br/>
<br/>

If you need more than 7 days worth of data, please <a href="/about">contact me</a>.
I have data going back for months.
<br/>
<br/>


<h2>System API calls</h2>

<h4>
/api/current/system
</h4>

Return a chronological list of which currently running trains are the latest.  
This is useful to get an overall picture of the Regional Rail train system.


<h4>
/api/current/system/latest <span class="badge">Added 3 Apr 2016</span>
</h4>

Return the latest reported info for each train in the entire system.  The
following data will be returned for each train:

<ul>
<li>Next stop</li>
<li>Minutes late</li>
<li>Source</li>
<li>Destination</li>
<li>Latitude</li>
<li>Longitude</li>
<li>Timestamp</li>
</ul>



<h4>
/api/current/system/totals
</h4>

Get a list of the total lateness of all running trains, by hour over the last 7 days.
<br/>

This is useful for comparing the current day to previous days in the event of bad weather, etc.


<h2>Train API calls</h2>

<h4>
/api/current/trains
</h4>

Get a list of all train numbers seen in the last 24 hours.


<h4>
/api/current/train/{train no}
</h4>

Get the current status of a train if it is running today.  Data includes
a list of stops made in chronological order and the lateness for each stop.

<h4>
/api/current/train/{train nos}/latest <span class="badge">Added 30 Mar 2016</span>
</h4>

Get the latest reported info for one or more trains.  If multiple trains are specified,
they should be comma-delimited.

The info returned includes: 
<ul>
<li>Next stop</li>
<li>Minutes late</li>
<li>Source</li>
<li>Destination</li>
<li>Latitude</li>
<li>Longitude</li>
<li>Timestamp</li>
</ul>


<h4>
/api/current/train/{train no}/history
</h4>

Get the lateness "history" of a specific train for the last 7 days, by stop.
<br/>

Note that not all trains run on all days.  Some trains are weekday only while others are weekend only.


<h4>
/api/current/train/{train no}/history/average
</h4>

Get the average lateness per stop of a given train.


<h2>Line API calls</h2>

<h4>
/api/current/lines
</h4>

Get a list of all train lines.

<h4>
/api/current/line/{train line}/outbound
</h4>

Get a list of all outbound trains for this line, and their lateness.

<h4>
/api/current/line/{train line}/inbound
</h4>

Get a list of all inbound trains for this line, and their lateness.

<h4>
/api/current/line/{train line}/{inbound, outbound}/latest <span class="badge">Added 3 Apr 2016</span>
</h4>

Return the latest reported info for each train in the specified line and direction.  The
following data will be returned for each train.

<ul>
<li>Next stop</li>
<li>Minutes late</li>
<li>Source</li>
<li>Destination</li>
<li>Latitude</li>
<li>Longitude</li>
<li>Timestamp</li>
</ul>


<h2>Station API calls</h2>

<h4>
/api/current/stations
</h4>

Get a list of all train stations.

<h4>
/api/current/station/{station name}/trains
</h4>

Get a list of all trains which have arrived at this station in the last 24 hours, and their lateness.

<h4>
/api/current/station/{station name}/trains/latest
</h4>

Get a list of the most recent trains which have arrived at this station, and their lateness.


<h4>
/api/current/station/{station name}/stats
</h4>

Get a list by hour of how many trains passed through that station, and the average lateness of each train.
<br/>
<br/>

</div><!-- /col -->
</div><!-- /row -->

{% endblock %}

